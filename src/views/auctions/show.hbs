<div class="row">
	<div class="d-md-flex flex-md-equal w-100 my-md-3 pl-md-3">
		<div class="col-6">
			<div class="bg-dark mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center text-white overflow-hidden">
				<div class="my-3 py-3">
					<h2 class="display-5">{{auction.title}}</h2>
					<img class="image" src="{{auction.image}}" width="400px" height="300px">
					{{#if ( eq id ownerid)}}
					<form action="/auctions/{{auction._id}}?_method=DELETE" method="POST">
						<button class="btn btn-danger mt-3"> Delete Auction</button>
						<a class="card-link btn btn-info mt-3" href="/auctions/{{auction._id}}/edit"> Edit</a>
					</form>
					{{/if}}
				</div>
			</div>
		</div>
		<div class="col-6">
			<div class="bg-light mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center">
				<div class="my-3 py-3">
					<div>
						<h5 class="display-8">Starting Price $ {{auction.price}}</h5>
						<p></p>
					</div>
					<div>
						<!-- <img src="person.png" width="50px" height="50px"> -->
						<p> Auctioneer : {{auction.owner.username}}</p>
					</div>
					<div>
						<h5 class="display-8">Current Highest Bid $ <span class="highestBid"
								id="highestBid">{{auction.highestBid}}</span></h5>
						<p></p>
					</div>
					<div>
						<!-- <img src="person.png" width="50px" height="50px"> -->
						<p> Highest Bidder : <span class="highestBidderName" id="highestBidderName">{{username}}</span>
						</p>
					</div>

					<div style="clear: right;" />

					{{#if ( ne id ownerid)}}
					{{!-- <form action="/auctions/{{id}}?_method=PUT" method="POST" novalidate class="validated-form">
						<label for="fname">My Bid:</label><br>
						<input class="input" type="number" id="fname" name="auction[highestBid]"></br>
						<button type="button" id ="bidSubmitBtn" class="btn btn-success">Submit</button>
					</form> --}}
					<form action="/auctions/{{auction._id}}/updateBid?_method=PUT" method="POST" novalidate
						class="validated-form">
						<div class="mb-4">
							<label class="form-label" for="myBid">My Bid:</label>
							<input class="form-control" type="text" id="myBid" name="auction[highestBid]">
						</div>
						<button class="btn btn-success">Submit</button>
					</form>
					{{/if}}

					<span class="setTime" id="setTime" style="visibility:hidden">{{auction.setTime}}</span>

					<i>
						<h6 class="display-12 ">Time left: </h6>
						<div class="timeLeft">
							<span id="days"></span>
							<span id="hours"></span>
							<span id="minutes"></span>
							<span id="seconds"></span>
							<span id="end"></span>

						</div>
					</i>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="row">
	<div class="bg-dark mr-md-3 pt-3 px-3 pt-md-5 px-md-5 text-center text-white overflow-hidden">
		<div class="my-3 py-3">
			<h2 class="display-5">Description</h2>
			<p class="lead">{{auction.description}}</p>
		</div>
	</div>
</div>

<!-- <h1>the delete cant get the auction._id</h1> -->
<h2>Reviews</h2>
{{#each auction.reviews }}
<div class="card mb-4">
	<div class="card-header">
		Name {{review.author.username}}
	</div>
	<div class="card-body">
		<blockquote class="blockquote mb-0">
			<p>Review: {{body}}</p>
			<p>Rating: {{rating}}</p>
		</blockquote>
	</div>
	<!-- Delete review button -->
	<!-- <form class="ml-5" action="/auctions/{{auction._id}}/{{review._id}}?_method=DELETE" method="POST">
		<button class="btn btn-danger mt-3"> Delete </button>
	</form> -->
</div>
{{/each}}
</div>
<!-- End Reviews for auctionner -->

<!-- leave a review for auctionner -->
<h2 class="mt-5">Leave a review</h2>
<!-- instead fo {{auction._id}} put {{currentUser._id}} -->
<form action="/auctions/{{auction._id}}/reviews" method="POST" class="mb-4 needs-validation" novalidate>
	<div class="mb-4">
		<label for="Range" class="form-label">Rating</label>
		<input type="range" class="form-range" min="0" max="5" name="review[rating]" id="Range">
	</div>

	<div class="mb-4">
		<label class="form-label" for="review">Review</label>
		<textarea class="form-control" name="review[body]" id="review" cols="15" rows="3" required></textarea>
		<div class="valid-feedback">
			Looks good!
		</div>
	</div>

	<button class="btn btn-success">Submit</button>
</form>

<!-- get autionner reviews
loop over them  
{{#each auction.owner.reviews}}
<p>Review: {{body}}</p>
<p>Rating: {{rating}}</p>
{{/each}}-->


<script type="text/javascript">


	//To handle the events of the submit button
	/*document.addEventListener('DOMContentLoaded', function(event) {
    
	let auctioneerName = document.getElementById()

   })*/

	//Logic for time
	let timeLeft = document.getElementById("setTime");
	time = timeLeft.innerHTML;
	console.log(time)

	// The data/time we want to countdown to
	let countDownDate = new Date(time);
	countDownDate.setDate(countDownDate.getDate() + 1);


	// Run myfunc every second
	let myfunc = setInterval(function () {

		let now = new Date().getTime();
		let timeleft = countDownDate.getTime() - now;

		// Calculating the days, hours, minutes and seconds left
		let days = Math.floor(timeleft / (1000 * 60 * 60 * 24));
		let hours = Math.floor((timeleft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
		let minutes = Math.floor((timeleft % (1000 * 60 * 60)) / (1000 * 60));
		let seconds = Math.floor((timeleft % (1000 * 60)) / 1000);

		// Result is output to the specific element
		document.getElementById("days").innerHTML = days + "d "
		document.getElementById("hours").innerHTML = hours + "h "
		document.getElementById("minutes").innerHTML = minutes + "m "
		document.getElementById("seconds").innerHTML = seconds + "s "

		// Display the message when countdown is over
		if (timeleft < 0) {
			clearInterval(myfunc);
			document.getElementById("days").innerHTML = ""
			document.getElementById("hours").innerHTML = ""
			document.getElementById("minutes").innerHTML = ""
			document.getElementById("seconds").innerHTML = ""
			document.getElementById("end").innerHTML = "Auction over!!";
		}
	}, 1000);

</script>